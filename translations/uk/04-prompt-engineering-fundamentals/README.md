<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "0135e6c271f3ece8699050d4debbce88",
  "translation_date": "2025-10-18T02:18:57+00:00",
  "source_file": "04-prompt-engineering-fundamentals/README.md",
  "language_code": "uk"
}
-->
# Основи інженерії запитів

[![Основи інженерії запитів](../../../translated_images/04-lesson-banner.a2c90deba7fedacda69f35b41636a8951ec91c2e33f5420b1254534ac85bc18e.uk.png)](https://youtu.be/GElCu2kUlRs?si=qrXsBvXnCW12epb8)

## Вступ
Цей модуль охоплює основні концепції та техніки створення ефективних запитів для генеративних моделей штучного інтелекту. Те, як ви формулюєте свій запит до LLM, також має значення. Ретельно складений запит може забезпечити кращу якість відповіді. Але що саме означають такі терміни, як _запит_ і _інженерія запитів_? І як я можу покращити _вхідний запит_, який я надсилаю до LLM? Це ті питання, на які ми спробуємо відповісти в цьому розділі та наступному.

_Генеративний штучний інтелект_ здатний створювати новий контент (наприклад, текст, зображення, аудіо, код тощо) у відповідь на запити користувачів. Це досягається за допомогою _великих мовних моделей_ (Large Language Models), таких як серія GPT ("Generative Pre-trained Transformer") від OpenAI, які навчені працювати з природною мовою та кодом.

Користувачі тепер можуть взаємодіяти з цими моделями, використовуючи знайомі парадигми, такі як чат, без необхідності технічної експертизи чи навчання. Моделі базуються на _запитах_ - користувачі надсилають текстовий запит (prompt) і отримують відповідь від штучного інтелекту (completion). Вони можуть "спілкуватися з AI" ітеративно, у багатокрокових розмовах, уточнюючи свій запит, поки відповідь не відповідатиме їхнім очікуванням.

"Запити" тепер стають основним _інтерфейсом програмування_ для додатків генеративного штучного інтелекту, визначаючи, що моделі мають робити, і впливаючи на якість отриманих відповідей. "Інженерія запитів" - це швидко зростаюча галузь досліджень, яка зосереджена на _розробці та оптимізації_ запитів для забезпечення стабільних і якісних відповідей у масштабі.

## Цілі навчання

У цьому уроці ми дізнаємося, що таке інженерія запитів, чому вона важлива і як ми можемо створювати більш ефективні запити для конкретної моделі та цільового застосування. Ми зрозуміємо основні концепції та найкращі практики інженерії запитів - і дізнаємося про інтерактивне середовище "пісочниці" Jupyter Notebooks, де ми можемо застосувати ці концепції до реальних прикладів.

До кінця цього уроку ми зможемо:

1. Пояснити, що таке інженерія запитів і чому вона важлива.
2. Описати компоненти запиту та їх використання.
3. Вивчити найкращі практики та техніки інженерії запитів.
4. Застосувати вивчені техніки до реальних прикладів, використовуючи кінцеву точку OpenAI.

## Основні терміни

Інженерія запитів: Практика розробки та вдосконалення вхідних даних для спрямування моделей штучного інтелекту на створення бажаних результатів.  
Токенізація: Процес перетворення тексту на менші одиниці, які називаються токенами, які модель може зрозуміти та обробити.  
LLM, налаштовані на інструкції: Великі мовні моделі (LLM), які були налаштовані з конкретними інструкціями для покращення точності та релевантності їхніх відповідей.

## Навчальна пісочниця

Інженерія запитів наразі більше схожа на мистецтво, ніж на науку. Найкращий спосіб покращити наше розуміння цього - це _більше практикуватися_ і застосовувати підхід проб і помилок, який поєднує експертизу в галузі застосування з рекомендованими техніками та оптимізаціями, специфічними для моделі.

Jupyter Notebook, що супроводжує цей урок, забезпечує середовище _пісочниці_, де ви можете спробувати те, що вивчаєте - під час уроку або як частину завдання з кодом наприкінці. Для виконання вправ вам знадобиться:

1. **Ключ API Azure OpenAI** - кінцева точка для розгорнутої LLM.  
2. **Середовище виконання Python** - у якому можна виконувати Notebook.  
3. **Локальні змінні середовища** - _виконайте [НАЛАШТУВАННЯ](./../00-course-setup/02-setup-local.md?WT.mc_id=academic-105485-koreyst) зараз, щоб підготуватися_.  

Notebook містить _початкові_ вправи - але вам рекомендується додати власні розділи _Markdown_ (опис) і _Code_ (запити) для тестування додаткових прикладів або ідей - і формування вашого розуміння дизайну запитів.

## Ілюстрований посібник

Хочете отримати загальне уявлення про те, що охоплює цей урок, перед тим як зануритися? Ознайомтеся з цим ілюстрованим посібником, який дає вам уявлення про основні теми уроку та ключові висновки, над якими варто подумати в кожному з них. Дорожня карта уроку веде вас від розуміння основних концепцій і викликів до їх вирішення за допомогою відповідних технік інженерії запитів і найкращих практик. Зверніть увагу, що розділ "Розширені техніки" в цьому посібнику стосується контенту, який охоплюється в _наступному_ розділі цієї програми.

![Ілюстрований посібник з інженерії запитів](../../../translated_images/04-prompt-engineering-sketchnote.d5f33336957a1e4f623b826195c2146ef4cc49974b72fa373de6929b474e8b70.uk.png)

## Наша стартап-ідея

Тепер поговоримо про те, як _ця тема_ пов'язана з нашою місією стартапу [впроваджувати інновації штучного інтелекту в освіту](https://educationblog.microsoft.com/2023/06/collaborating-to-bring-ai-innovation-to-education?WT.mc_id=academic-105485-koreyst). Ми хочемо створювати додатки на основі штучного інтелекту для _персоналізованого навчання_ - тому давайте подумаємо, як різні користувачі нашого додатка можуть "створювати" запити:

- **Адміністратори** можуть попросити AI _проаналізувати дані навчальних програм, щоб виявити прогалини в охопленні_. AI може підсумувати результати або візуалізувати їх за допомогою коду.  
- **Викладачі** можуть попросити AI _створити план уроку для цільової аудиторії та теми_. AI може створити персоналізований план у заданому форматі.  
- **Студенти** можуть попросити AI _допомогти їм у складному предметі_. AI може тепер направляти студентів за допомогою уроків, підказок і прикладів, адаптованих до їхнього рівня.  

І це лише верхівка айсберга. Ознайомтеся з [Prompts For Education](https://github.com/microsoft/prompts-for-edu/tree/main?WT.mc_id=academic-105485-koreyst) - відкритою бібліотекою запитів, створеною експертами в галузі освіти - щоб отримати ширше уявлення про можливості! _Спробуйте запустити деякі з цих запитів у пісочниці або використовуючи OpenAI Playground, щоб побачити, що станеться!_

## Що таке інженерія запитів?

Ми почали цей урок з визначення **інженерії запитів** як процесу _розробки та оптимізації_ текстових запитів (prompts) для забезпечення стабільних і якісних відповідей (completions) для конкретної цільової задачі та моделі. Ми можемо розглядати це як процес із двох етапів:

- _розробка_ початкового запиту для конкретної моделі та задачі  
- _вдосконалення_ запиту ітеративно для покращення якості відповіді  

Це обов'язково процес проб і помилок, який вимагає інтуїції користувача та зусиль для досягнення оптимальних результатів. Чому це важливо? Щоб відповісти на це питання, спочатку потрібно зрозуміти три концепції:

- _Токенізація_ = як модель "бачить" запит  
- _Базові LLM_ = як основна модель "обробляє" запит  
- _LLM, налаштовані на інструкції_ = як модель тепер бачить "завдання"  

### Токенізація

LLM бачить запити як _послідовність токенів_, де різні моделі (або версії моделі) можуть токенізувати один і той самий запит по-різному. Оскільки LLM навчаються на токенах (а не на сирому тексті), спосіб токенізації запитів має прямий вплив на якість згенерованої відповіді.

Щоб отримати уявлення про те, як працює токенізація, спробуйте інструменти, такі як [OpenAI Tokenizer](https://platform.openai.com/tokenizer?WT.mc_id=academic-105485-koreyst), показаний нижче. Скопіюйте свій запит - і подивіться, як він перетворюється на токени, звертаючи увагу на те, як обробляються символи пробілу та розділові знаки. Зверніть увагу, що цей приклад показує старішу модель LLM (GPT-3) - тому спроба цього з новішою моделлю може дати інший результат.

![Токенізація](../../../translated_images/04-tokenizer-example.e71f0a0f70356c5c7d80b21e8753a28c18a7f6d4aaa1c4b08e65d17625e85642.uk.png)

### Концепція: Основні моделі

Після токенізації запиту основна функція ["Базової LLM"](https://blog.gopenai.com/an-introduction-to-base-and-instruction-tuned-large-language-models-8de102c785a6?WT.mc_id=academic-105485-koreyst) (або основної моделі) полягає в прогнозуванні наступного токена в цій послідовності. Оскільки LLM навчаються на величезних текстових наборах даних, вони добре розуміють статистичні зв'язки між токенами і можуть зробити це прогнозування з певною впевненістю. Зверніть увагу, що вони не розуміють _значення_ слів у запиті або токені; вони просто бачать шаблон, який можуть "завершити" своїм наступним прогнозом. Вони можуть продовжувати прогнозувати послідовність, поки користувач не втрутиться або не буде виконано певну попередньо встановлену умову.

Хочете побачити, як працює завершення на основі запиту? Введіть наведений вище запит у [_Chat Playground_](https://oai.azure.com/playground?WT.mc_id=academic-105485-koreyst) Azure OpenAI Studio з налаштуваннями за замовчуванням. Система налаштована на те, щоб розглядати запити як запити на інформацію - тому ви повинні побачити завершення, яке відповідає цьому контексту.

Але що, якщо користувач хотів побачити щось конкретне, що відповідає певним критеріям або цільовій задачі? Тут у гру вступають _LLM, налаштовані на інструкції_.

![Завершення чату базової LLM](../../../translated_images/04-playground-chat-base.65b76fcfde0caa6738e41d20f1a6123f9078219e6f91a88ee5ea8014f0469bdf.uk.png)

### Концепція: LLM, налаштовані на інструкції

[LLM, налаштовані на інструкції](https://blog.gopenai.com/an-introduction-to-base-and-instruction-tuned-large-language-models-8de102c785a6?WT.mc_id=academic-105485-koreyst) починаються з основної моделі та налаштовуються за допомогою прикладів або пар вводу/виводу (наприклад, багатокрокових "повідомлень"), які можуть містити чіткі інструкції - і відповідь AI намагається слідувати цим інструкціям.

Це використовує такі техніки, як навчання з підкріпленням із зворотним зв'язком від людини (RLHF), які можуть навчити модель _слідувати інструкціям_ і _вчитися на зворотному зв'язку_, щоб вона створювала відповіді, які краще підходять для практичних застосувань і більш релевантні цільовим задачам користувача.

Давайте спробуємо це - поверніться до наведеного вище запиту, але тепер змініть _системне повідомлення_, щоб надати наступну інструкцію як контекст:

> _Підсумуйте наданий контент для учня другого класу. Залиште результат у вигляді одного абзацу з 3-5 пунктами._

Подивіться, як результат тепер налаштований відповідно до бажаної мети та формату? Викладач тепер може безпосередньо використовувати цю відповідь у своїх слайдах для цього класу.

![Завершення чату LLM, налаштованої на інструкції](../../../translated_images/04-playground-chat-instructions.b30bbfbdf92f2d051639c9bc23f74a0e2482f8dc7f0dafc6cc6fda81b2b00534.uk.png)

## Чому нам потрібна інженерія запитів?

Тепер, коли ми знаємо, як LLM обробляють запити, поговоримо про _чому_ нам потрібна інженерія запитів. Відповідь полягає в тому, що поточні LLM мають низку викликів, які ускладнюють досягнення _надійних і стабільних завершень_ без зусиль у створенні та оптимізації запитів. Наприклад:

1. **Відповіді моделі є стохастичними.** _Один і той самий запит_ ймовірно створить різні відповіді з різними моделями або версіями моделі. І він може навіть створити різні результати з _тією самою моделлю_ у різний час. _Техніки інженерії запитів можуть допомогти нам мінімізувати ці варіації, забезпечуючи кращі обмеження_.  

1. **Моделі можуть вигадувати відповіді.** Моделі попередньо навчені на _великих, але обмежених_ наборах даних, що означає, що вони не мають знань про концепції поза межами цього навчального обсягу. У результаті вони можуть створювати завершення, які є неточними, вигаданими або прямо суперечать відомим фактам. _Техніки інженерії запитів допомагають користувачам ідентифікувати та зменшувати такі вигадки, наприклад, запитуючи у AI посилання або обґрунтування_.  

1. **Можливості моделей будуть різними.** Новіші моделі або покоління моделей матимуть багатші можливості, але також принесуть унікальні особливості та компроміси в вартості та складності. _Інженерія запитів може допомогти нам розробити найкращі практики та робочі процеси, які абстрагують відмінності та адаптуються до специфічних вимог моделі масштабованим і безперебійним способом_.  

Давайте побачимо це в дії в OpenAI або Azure OpenAI Playground:

- Використовуйте один і той самий запит з різними розгортаннями LLM (наприклад, OpenAI, Azure OpenAI, Hugging Face) - чи побачили ви варіації?  
- Використовуйте один і той самий запит повторно з _тим самим_ розгортанням LLM (наприклад, Azure OpenAI Playground) - як ці варіації відрізнялися?  

### Приклад вигадок

У цьому курсі ми використовуємо термін **"вигадка"** для позначення явища, коли LLM іноді генерують фактично некоректну інформацію через обмеження в
Пошук в Інтернеті показав, що існують вигадані розповіді (наприклад, телесеріали або книги) про війни на Марсі, але жодна з них не стосується 2076 року. Здоровий глузд також підказує, що 2076 рік — це _майбутнє_, і тому він не може бути пов'язаний із реальними подіями.

Що ж відбувається, коли ми запускаємо цей запит із різними постачальниками LLM?

> **Відповідь 1**: OpenAI Playground (GPT-35)

![Відповідь 1](../../../translated_images/04-fabrication-oai.5818c4e0b2a2678c40e0793bf873ef4a425350dd0063a183fb8ae02cae63aa0c.uk.png)

> **Відповідь 2**: Azure OpenAI Playground (GPT-35)

![Відповідь 2](../../../translated_images/04-fabrication-aoai.b14268e9ecf25caf613b7d424c16e2a0dc5b578f8f960c0c04d4fb3a68e6cf61.uk.png)

> **Відповідь 3**: Hugging Face Chat Playground (LLama-2)

![Відповідь 3](../../../translated_images/04-fabrication-huggingchat.faf82a0a512789565e410568bce1ac911075b943dec59b1ef4080b61723b5bf4.uk.png)

Як і очікувалося, кожна модель (або версія моделі) генерує трохи різні відповіді завдяки стохастичній поведінці та варіаціям у можливостях моделі. Наприклад, одна модель орієнтована на аудиторію восьмого класу, тоді як інша — на старшокласників. Але всі три моделі створили відповіді, які могли б переконати необізнаного користувача, що подія була реальною.

Техніки створення запитів, такі як _метапромптинг_ і _налаштування температури_, можуть зменшити вигадки моделі до певної міри. Нові архітектури створення запитів також інтегрують нові інструменти та техніки в потік запитів, щоб зменшити або мінімізувати деякі з цих ефектів.

## Кейс: GitHub Copilot

Завершимо цей розділ, отримавши уявлення про те, як створення запитів використовується в реальних рішеннях, розглянувши один кейс: [GitHub Copilot](https://github.com/features/copilot?WT.mc_id=academic-105485-koreyst).

GitHub Copilot — це ваш "AI-помічник програміста" — він перетворює текстові запити на завершення коду та інтегрується у ваше середовище розробки (наприклад, Visual Studio Code) для зручного користування. Як задокументовано в серії блогів нижче, найперша версія була заснована на моделі OpenAI Codex — і інженери швидко зрозуміли необхідність налаштування моделі та розробки кращих технік створення запитів для покращення якості коду. У липні вони [представили вдосконалену AI-модель, яка перевершує Codex](https://github.blog/2023-07-28-smarter-more-efficient-coding-github-copilot-goes-beyond-codex-with-improved-ai-model/?WT.mc_id=academic-105485-koreyst) для ще швидших пропозицій.

Читайте публікації в порядку, щоб простежити їхній шлях навчання.

- **Травень 2023** | [GitHub Copilot стає кращим у розумінні вашого коду](https://github.blog/2023-05-17-how-github-copilot-is-getting-better-at-understanding-your-code/?WT.mc_id=academic-105485-koreyst)
- **Травень 2023** | [Всередині GitHub: Робота з LLM, які стоять за GitHub Copilot](https://github.blog/2023-05-17-inside-github-working-with-the-llms-behind-github-copilot/?WT.mc_id=academic-105485-koreyst).
- **Червень 2023** | [Як писати кращі запити для GitHub Copilot](https://github.blog/2023-06-20-how-to-write-better-prompts-for-github-copilot/?WT.mc_id=academic-105485-koreyst).
- **Липень 2023** | [.. GitHub Copilot перевершує Codex завдяки вдосконаленій AI-моделі](https://github.blog/2023-07-28-smarter-more-efficient-coding-github-copilot-goes-beyond-codex-with-improved-ai-model/?WT.mc_id=academic-105485-koreyst)
- **Липень 2023** | [Посібник для розробників зі створення запитів та LLM](https://github.blog/2023-07-17-prompt-engineering-guide-generative-ai-llms/?WT.mc_id=academic-105485-koreyst)
- **Вересень 2023** | [Як створити корпоративний додаток на основі LLM: уроки від GitHub Copilot](https://github.blog/2023-09-06-how-to-build-an-enterprise-llm-application-lessons-from-github-copilot/?WT.mc_id=academic-105485-koreyst)

Ви також можете переглянути їхній [інженерний блог](https://github.blog/category/engineering/?WT.mc_id=academic-105485-koreyst) для інших публікацій, таких як [ця](https://github.blog/2023-09-27-how-i-used-github-copilot-chat-to-build-a-reactjs-gallery-prototype/?WT.mc_id=academic-105485-koreyst), яка показує, як ці моделі та техніки _застосовуються_ для створення реальних додатків.

---

## Конструкція запиту

Ми вже бачили, чому створення запитів важливе — тепер давайте зрозуміємо, як запити _конструюються_, щоб ми могли оцінити різні техніки для більш ефективного створення запитів.

### Базовий запит

Почнемо з базового запиту: текстовий ввід, який надсилається моделі без додаткового контексту. Ось приклад — коли ми надсилаємо перші кілька слів національного гімну США до OpenAI [Completion API](https://platform.openai.com/docs/api-reference/completions?WT.mc_id=academic-105485-koreyst), він миттєво _доповнює_ відповідь наступними рядками, ілюструючи базову поведінку передбачення.

| Запит (Вхід)     | Завершення (Вихід)                                                                                                                        |
| :--------------- | :---------------------------------------------------------------------------------------------------------------------------------------- |
| Oh say can you see | Здається, ви починаєте текст "Зірково-смугастого прапора", національного гімну Сполучених Штатів. Повний текст звучить ...               |

### Складний запит

Тепер додамо контекст і інструкції до базового запиту. [Chat Completion API](https://learn.microsoft.com/azure/ai-services/openai/how-to/chatgpt?WT.mc_id=academic-105485-koreyst) дозволяє нам створити складний запит як набір _повідомлень_ з:

- Парами ввід/вивід, що відображають _ввід користувача_ та _відповідь асистента_.
- Системним повідомленням, яке встановлює контекст для поведінки або особистості асистента.

Запит тепер має форму, де _токенізація_ ефективно захоплює відповідну інформацію з контексту та розмови. Тепер зміна системного контексту може мати такий же вплив на якість завершень, як і надані ввідні дані користувача.

```python
response = openai.chat.completions.create(
    model="gpt-3.5-turbo",
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Who won the world series in 2020?"},
        {"role": "assistant", "content": "The Los Angeles Dodgers won the World Series in 2020."},
        {"role": "user", "content": "Where was it played?"}
    ]
)
```

### Інструкційний запит

У наведених вище прикладах запит користувача був простим текстовим запитом, який можна інтерпретувати як запит на інформацію. З _інструкційними_ запитами ми можемо використовувати цей текст для більш детального визначення завдання, надаючи штучному інтелекту кращі вказівки. Ось приклад:

| Запит (Вхід)                                                                                                                                                                                                                         | Завершення (Вихід)                                                                                                        | Тип інструкції      |
| :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------- | :------------------ |
| Напишіть опис Громадянської війни                                                                                                                                                                                                    | _повернуто простий абзац_                                                                                                | Простий             |
| Напишіть опис Громадянської війни. Вкажіть ключові дати та події та опишіть їх значення                                                                                                        | _повернуто абзац, за яким слідує список ключових дат подій із описами_                                                   | Складний            |
| Напишіть опис Громадянської війни в 1 абзаці. Вкажіть 3 марковані пункти з ключовими датами та їх значенням. Вкажіть ще 3 марковані пункти з ключовими історичними постатями та їх внеском. Поверніть результат у форматі JSON-файлу | _повернуто більш детальну інформацію у текстовому полі, відформатовану як JSON, яку можна скопіювати та перевірити_       | Складний. Форматований. |

## Основний контент

У наведених вище прикладах запит все ще був досить відкритим, дозволяючи LLM вирішувати, яка частина його попередньо навченої бази даних є релевантною. З _основним контентом_ вхідний текст ділиться на дві частини:

- інструкція (дія)
- релевантний контент (який впливає на дію)

Ось приклад, де інструкція — "підсумуйте це у 2 реченнях".

| Запит (Вхід)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Завершення (Вихід)                                                                                                                                                                                                                                                                             |
| :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Юпітер — п'ята планета від Сонця і найбільша в Сонячній системі. Це газовий гігант з масою, що становить одну тисячну маси Сонця, але в два з половиною рази більше, ніж усі інші планети Сонячної системи разом узяті. Юпітер є одним із найяскравіших об'єктів, видимих неозброєним оком у нічному небі, і був відомий стародавнім цивілізаціям ще до записаної історії. Він названий на честь римського бога Юпітера.[19] Коли його видно з Землі, Юпітер може бути настільки яскравим, що його відбите світло може відкидати видимі тіні,[20] і в середньому це третій за яскравістю природний об'єкт у нічному небі після Місяця та Венери. <br/> **Підсумуйте це у 2 коротких реченнях** | Юпітер — найбільша планета Сонячної системи, п'ята від Сонця, і є одним із найяскравіших об'єктів нічного неба. Названий на честь римського бога Юпітера, це газовий гігант, маса якого в два з половиною рази перевищує масу всіх інших планет Сонячної системи разом узятих. |

Сегмент основного контенту можна використовувати різними способами для більш ефективних інструкцій:

- **Приклади** — замість того, щоб прямо казати моделі, що робити, надайте їй приклади бажаного результату і дозвольте їй вивести шаблон.
- **Підказки** — після інструкції додайте "підказку", яка спрямовує завершення, допомагаючи моделі створювати більш релевантні відповіді.
- **Шаблони** — це повторювані "рецепти" для запитів із заповнювачами (змінними), які можна налаштувати даними для конкретних випадків використання.

Давайте розглянемо ці методи в дії.

### Використання прикладів

Це підхід, коли ви використовуєте основний контент, щоб "нагодувати модель" кількома прикладами бажаного результату для даної інструкції, і дозволяєте їй вивести шаблон для бажаного результату. Залежно від кількості наданих прикладів, ми можемо мати запити без прикладів, з одним прикладом, з кількома прикладами тощо.

Тепер запит складається з трьох компонентів:

- Опис завдання
- Кілька прикладів бажаного результату
- Початок нового прикладу (який стає неявним описом завдання)

| Тип навчання | Запит (Вхід)                                                                                                                                        | Завершення (Вихід)         |
| :----------- | :-------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------- |
| Без прикладів | "Сонце світить". Перекладіть на іспанську                                                                                                          | "El Sol está brillando".    |
| Один приклад  | "Сонце світить" => ""El Sol está brillando". <br> "Це холодний і вітряний день" =>                                                                 | "Es un día frío y ventoso". |
| Кілька прикладів | Гравець пробіг бази => Бейсбол <br/> Гравець зробив ейс => Теніс <br/> Гравець забив шістку => Крикет <br/> Гравець зробив слем-данк =>         | Баскетбол                  |
|               |                                                                                                                                                     |                             |

Зверніть увагу, як у запиті без прикладів довелося надати явну інструкцію ("Перекладіть на іспанську"), але вона стає зрозумілою у прикладі з одним запитом. Приклад із кількома запитами показує, як додавання більшої кількості прикладів дозволяє моделям робити більш точні висновки без додаткових інструкцій.

### Підказки для запиту

Ще одна техніка використання основного контенту — це надання _підказок_ замість прикладів. У цьому випадку ми даємо моделі натяк у правильному напрямку, _починаючи_ її з фрагмента, який відображає бажаний формат відповіді. Модель потім "бере підказку" і продовжує в тому ж напрямку.

| Кількість підказок | Запит (Вхід)                                                                                                                                                                                                                                                                                                                                                                                                                                               | Завершення (Вихід)                                                                                                                                                                                                                                                                                       |
| :----------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 0                  | Юпітер — п'ята планета від Сонця і найбільша в Сонячній системі. Це газовий гігант з масою, що становить одну тисячну маси Сонця, але в два з половиною рази більше, ніж усі інші планети Сонячної системи разом узяті. Юпітер є одним із найяскравіших об'єктів, видимих неозброєним оком у нічному небі, і був відомий стародавнім цивілізаціям ще до записаної історії. <br/>**Підсумуйте це**                                       | Юпітер — найбільша планета в нашій Сонячній системі і п'ята від Сонця. Це газовий гігант, маса якого в два з половиною рази перевищує масу всіх інших планет разом узятих. Стародавні цивілізації давно знали про Юпітер, і він легко видимий у нічному небі. |
| 1              | Юпітер — п'ята планета від Сонця і найбільша в Сонячній системі. Це газовий гігант із масою, що становить одну тисячну маси Сонця, але в два з половиною рази перевищує масу всіх інших планет Сонячної системи разом узятих. Юпітер є одним із найяскравіших об'єктів, видимих неозброєним оком у нічному небі, і був відомий стародавнім цивілізаціям ще до початку записаної історії. <br/>**Підсумуйте це** <br/> Ми дізналися, що Юпітер | є п'ятою планетою від Сонця і найбільшою в Сонячній системі. Це газовий гігант із масою, що становить одну тисячну маси Сонця, але в два з половиною рази перевищує масу всіх інших планет разом узятих. Він легко видимий неозброєним оком і був відомий з давніх часів.                        |
| 2              | Юпітер — п'ята планета від Сонця і найбільша в Сонячній системі. Це газовий гігант із масою, що становить одну тисячну маси Сонця, але в два з половиною рази перевищує масу всіх інших планет Сонячної системи разом узятих. Юпітер є одним із найяскравіших об'єктів, видимих неозброєним оком у нічному небі, і був відомий стародавнім цивілізаціям ще до початку записаної історії. <br/>**Підсумуйте це** <br/> Топ-3 факти, які ми дізналися:         | 1. Юпітер — п'ята планета від Сонця і найбільша в Сонячній системі. <br/> 2. Це газовий гігант із масою, що становить одну тисячну маси Сонця...<br/> 3. Юпітер був видимий неозброєним оком з давніх часів ...                                                                       |
|                |                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                           |

### Шаблони запитів

Шаблон запиту — це _заздалегідь визначений рецепт запиту_, який можна зберігати та використовувати повторно за потреби, щоб забезпечити більш послідовний досвід користувачів у масштабі. У найпростішій формі це просто колекція прикладів запитів, як [цей від OpenAI](https://platform.openai.com/examples?WT.mc_id=academic-105485-koreyst), що містить як інтерактивні компоненти запиту (повідомлення користувача та системи), так і формат запиту через API — для підтримки повторного використання.

У більш складній формі, як [цей приклад від LangChain](https://python.langchain.com/docs/concepts/prompt_templates/?WT.mc_id=academic-105485-koreyst), він містить _заповнювачі_, які можна замінити даними з різних джерел (введення користувача, контекст системи, зовнішні джерела даних тощо), щоб динамічно створювати запит. Це дозволяє створювати бібліотеку повторно використовуваних запитів, які можна використовувати для забезпечення послідовного досвіду користувачів **програмно** у масштабі.

Нарешті, справжня цінність шаблонів полягає у здатності створювати та публікувати _бібліотеки запитів_ для вертикальних доменів застосування, де шаблон запиту тепер _оптимізований_ для відображення контексту або прикладів, специфічних для застосування, що робить відповіді більш релевантними та точними для цільової аудиторії користувачів. Репозиторій [Prompts For Edu](https://github.com/microsoft/prompts-for-edu?WT.mc_id=academic-105485-koreyst) є чудовим прикладом цього підходу, який збирає бібліотеку запитів для освітньої сфери з акцентом на ключові цілі, такі як планування уроків, розробка навчальних програм, репетиторство студентів тощо.

## Додатковий контент

Якщо ми розглядаємо створення запитів як процес, що включає інструкцію (завдання) та ціль (основний контент), то _додатковий контент_ — це як додатковий контекст, який ми надаємо, щоб **вплинути на результат певним чином**. Це можуть бути параметри налаштування, інструкції з форматування, таксономії тем тощо, які допомагають моделі _адаптувати_ свою відповідь до бажаних цілей або очікувань користувача.

Наприклад: маючи каталог курсів із розширеними метаданими (назва, опис, рівень, теги метаданих, викладач тощо) для всіх доступних курсів у навчальній програмі:

- ми можемо визначити інструкцію "підсумувати каталог курсів на осінь 2023 року"
- ми можемо використати основний контент, щоб надати кілька прикладів бажаного результату
- ми можемо використати додатковий контент, щоб визначити топ-5 "тегів", які нас цікавлять.

Тепер модель може надати підсумок у форматі, показаному в кількох прикладах, але якщо результат має кілька тегів, вона може пріоритизувати 5 тегів, визначених у додатковому контенті.

---

<!--
Шаблон уроку:
Цей блок має охоплювати основну концепцію №1.
Підкріпіть концепцію прикладами та посиланнями.

КОНЦЕПЦІЯ №3:
Техніки інженерії запитів.
Які основні техніки інженерії запитів?
Ілюструйте це вправами.
-->

## Найкращі практики створення запитів

Тепер, коли ми знаємо, як можна _створювати_ запити, ми можемо почати думати про те, як їх _розробляти_, враховуючи найкращі практики. Ми можемо розглядати це у двох частинах — правильний _підхід_ і застосування правильних _технік_.

### Підхід до інженерії запитів

Інженерія запитів — це процес проб і помилок, тому пам'ятайте про три основні керівні принципи:

1. **Розуміння домену має значення.** Точність і релевантність відповіді залежать від _домену_, в якому працює цей додаток або користувач. Використовуйте свою інтуїцію та експертність у домені, щоб **додатково налаштувати техніки**. Наприклад, визначте _особливості домену_ у своїх системних запитах або використовуйте _шаблони, специфічні для домену_ у своїх запитах користувача. Надайте додатковий контент, який відображає контексти, специфічні для домену, або використовуйте _підказки та приклади, специфічні для домену_, щоб спрямувати модель до знайомих шаблонів використання.

2. **Розуміння моделі має значення.** Ми знаємо, що моделі за своєю природою є стохастичними. Але реалізації моделей також можуть відрізнятися за набором даних, який вони використовують для навчання (заздалегідь підготовлені знання), можливостями, які вони надають (наприклад, через API або SDK), і типом контенту, для якого вони оптимізовані (наприклад, код, зображення або текст). Розумійте сильні сторони та обмеження моделі, яку ви використовуєте, і використовуйте ці знання, щоб _пріоритизувати завдання_ або створювати _налаштовані шаблони_, оптимізовані для можливостей моделі.

3. **Ітерація та перевірка мають значення.** Моделі швидко розвиваються, як і техніки інженерії запитів. Як експерт у домені, ви можете мати інший контекст або критерії для _вашого_ конкретного застосування, які можуть не стосуватися ширшої спільноти. Використовуйте інструменти та техніки інженерії запитів, щоб "запустити" створення запитів, потім ітеративно перевіряйте результати, використовуючи свою інтуїцію та експертність у домені. Записуйте свої висновки та створюйте **базу знань** (наприклад, бібліотеки запитів), які можуть бути використані як нова база іншими для швидших ітерацій у майбутньому.

## Найкращі практики

Тепер давайте розглянемо загальні найкращі практики, які рекомендують [OpenAI](https://help.openai.com/en/articles/6654000-best-practices-for-prompt-engineering-with-openai-api?WT.mc_id=academic-105485-koreyst) та фахівці [Azure OpenAI](https://learn.microsoft.com/azure/ai-services/openai/concepts/prompt-engineering#best-practices?WT.mc_id=academic-105485-koreyst).

| Що                              | Чому                                                                                                                                                                                                                                               |
| :-------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Оцінюйте найновіші моделі.       | Нові покоління моделей, ймовірно, мають покращені функції та якість, але можуть також спричинити вищі витрати. Оцінюйте їх вплив, а потім приймайте рішення про міграцію.                                                                                |
| Розділяйте інструкції та контекст   | Перевірте, чи ваш постачальник моделі визначає _роздільники_, щоб чіткіше розрізняти інструкції, основний і додатковий контент. Це може допомогти моделям точніше призначати вагу токенам.                                                         |
| Будьте конкретними та чіткими             | Надавайте більше деталей про бажаний контекст, результат, довжину, формат, стиль тощо. Це покращить як якість, так і послідовність відповідей. Фіксуйте рецепти у повторно використовуваних шаблонах.                                                          |
| Будьте описовими, використовуйте приклади      | Моделі можуть краще реагувати на підхід "показати і розказати". Почніть з підходу `zero-shot`, де ви даєте інструкцію (але без прикладів), потім спробуйте `few-shot` як уточнення, надаючи кілька прикладів бажаного результату. Використовуйте аналогії. |
| Використовуйте підказки для запуску завершень | Спрямуйте модель до бажаного результату, надавши їй кілька початкових слів або фраз, які вона може використати як відправну точку для відповіді.                                                                                                               |
| Повторюйте                       | Іноді вам може знадобитися повторити інструкцію моделі. Давайте інструкції перед і після основного контенту, використовуйте інструкцію та підказку тощо. Ітеративно перевіряйте, щоб побачити, що працює.                                                         |
| Порядок має значення                     | Порядок, у якому ви представляєте інформацію моделі, може вплинути на результат, навіть у навчальних прикладах, завдяки ефекту недавності. Спробуйте різні варіанти, щоб побачити, що працює найкраще.                                                               |
| Дайте моделі "вихід"           | Надайте моделі _резервний_ варіант відповіді, який вона може надати, якщо з будь-якої причини не може виконати завдання. Це може зменшити ймовірність того, що моделі генеруватимуть хибні або вигадані відповіді.                                                         |
|                                   |                                                                                                                                                                                                                                                   |

Як і у випадку з будь-якою найкращою практикою, пам'ятайте, що _ваш досвід може відрізнятися_ залежно від моделі, завдання та домену. Використовуйте ці рекомендації як відправну точку та ітеративно вдосконалюйте, щоб знайти те, що найкраще працює для вас. Постійно переоцінюйте свій процес інженерії запитів, коли стають доступними нові моделі та інструменти, з акцентом на масштабованість процесу та якість відповідей.

<!--
Шаблон уроку:
Цей блок має надати завдання з кодом, якщо це можливо.

ЗАВДАННЯ:
Посилання на Jupyter Notebook з лише коментарями до коду в інструкціях (розділи коду порожні).

РІШЕННЯ:
Посилання на копію цього Notebook з заповненими та виконаними запитами, що показує один приклад.
-->

## Завдання

Вітаємо! Ви дійшли до кінця уроку! Настав час перевірити деякі з цих концепцій і технік на практиці за допомогою реальних прикладів!

Для нашого завдання ми будемо використовувати Jupyter Notebook з вправами, які ви можете виконувати інтерактивно. Ви також можете розширити Notebook власними комірками Markdown і Code, щоб досліджувати ідеї та техніки самостійно.

### Щоб почати, зробіть форк репозиторію, а потім

- (Рекомендовано) Запустіть GitHub Codespaces
- (Альтернативно) Клонуйте репозиторій на свій локальний пристрій і використовуйте його з Docker Desktop
- (Альтернативно) Відкрийте Notebook у своєму улюбленому середовищі виконання Notebook.

### Далі налаштуйте змінні середовища

- Скопіюйте файл `.env.copy` у кореневій папці репозиторію до `.env` і заповніть значення `AZURE_OPENAI_API_KEY`, `AZURE_OPENAI_ENDPOINT` та `AZURE_OPENAI_DEPLOYMENT`. Поверніться до [розділу Learning Sandbox](../../../04-prompt-engineering-fundamentals/04-prompt-engineering-fundamentals), щоб дізнатися, як це зробити.

### Далі відкрийте Jupyter Notebook

- Виберіть ядро виконання. Якщо використовуєте варіанти 1 або 2, просто виберіть стандартне ядро Python 3.10.x, яке надається контейнером розробки.

Ви готові виконувати вправи. Зверніть увагу, що тут немає _правильних і неправильних_ відповідей — просто досліджуйте варіанти методом проб і помилок і формуйте інтуїцію щодо того, що працює для конкретної моделі та домену застосування.

_З цієї причини в цьому уроці немає сегментів з рішеннями коду. Замість цього в Notebook будуть комірки Markdown з назвою "Моє рішення:", які показують один приклад результату для довідки._

 <!--
Шаблон уроку:
Завершіть розділ підсумком і ресурсами для самостійного навчання.
-->

## Перевірка знань

Який із наведених запитів є хорошим, враховуючи деякі розумні найкращі практики?

1. Покажіть мені зображення червоної машини
2. Покажіть мені зображення червоної машини марки Volvo і моделі XC90, припаркованої біля скелі на заході сонця
3. Покажіть мені зображення червоної машини марки Volvo і моделі XC90

A: 2, це найкращий запит, оскільки він надає деталі про "що" і переходить до конкретики (не просто будь-яка машина, а конкретна марка і модель), а також описує загальну обстановку. 3 — наступний найкращий варіант, оскільки він також містить багато опису.

## 🚀 Виклик

Спробуйте використати техніку "підказки" з запитом: Завершіть речення "Покажіть мені зображення червоної машини марки Volvo і ". Що модель відповість, і як ви б це покращили?

## Чудова робота! Продовжуйте навчання

Хочете дізнатися більше про різні концепції інженерії запитів? Перейдіть на [сторінку продовження навчання](https://aka.ms/genai-collection?WT.mc_id=academic-105485-koreyst), щоб знайти інші чудові ресурси на цю тему.

Перейдіть до уроку 5, де ми розглянемо [просунуті техніки створення запитів](../05-advanced-prompts/README.md?WT.mc_id=academic-105485-koreyst)!

---

**Відмова від відповідальності**:  
Цей документ був перекладений за допомогою сервісу автоматичного перекладу [Co-op Translator](https://github.com/Azure/co-op-translator). Хоча ми прагнемо до точності, будь ласка, майте на увазі, що автоматичні переклади можуть містити помилки або неточності. Оригінальний документ на його рідній мові слід вважати авторитетним джерелом. Для критичної інформації рекомендується професійний людський переклад. Ми не несемо відповідальності за будь-які непорозуміння або неправильні тлумачення, що виникають внаслідок використання цього перекладу.